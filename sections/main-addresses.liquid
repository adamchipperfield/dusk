<div class="main-account__header">
  {{ 'customer.account.return' | t | link_to: routes.account_url, class: 'text-link main-account__return' }}

  <h1 class="text-h4">{{ 'customer.account.addresses' | t }}</h1>

  <toggle-element-button toggle-id="new-address">
    <button class="button button--small">
      {{ 'customer.address.new_address' | t }}
    </button>
  </toggle-element-button>
</div>

<toggle-element class="dialog-window" id="new-address" preset="dialog">
  <div class="drawer" data-ref="toggle-element.dialog">
    <div class="drawer__header">
      <p class="text-h5">{{ 'customer.address.new_address' | t }}</p>

      <button
        class="drawer__close button-reset"
        type="button"
        title="{{ 'accessibility.close_drawer' | t }}"
        data-ref="toggle-element.close"
      >
        {% render 'icon-misc', icon: 'cancel' %}
      </button>
    </div>

    <div class="drawer__body">
      {% render 'address-form', address: customer.new_address %}
    </div>
  </div>
</toggle-element>

{% paginate customer.addresses by section.settings.addresses_per_page %}
  <ul class="main-account__addresses list-reset grid">
    {% for address in customer.addresses %}
      <li class="main-account__address col xs12 l4">
        {% if address == customer.default_address %}
          <p class="label no-margin">{{ 'customer.account.default_address' | t }}</p>
        {% endif %}

        {{ address | format_address }}

        <div class="button-group button-group--inline">
          <toggle-element-button toggle-id="{{ address.id }}">
            <button class="button button--small button--secondary">
              {{ 'customer.address.edit_address' | t }}
            </button>
          </toggle-element-button>

          <form
            action="{{ routes.account_addresses_url }}/{{ address.id }}"
            method="POST"
          >
            <input
              name="_method"
              type="hidden"
              value="delete"
            >

            <button class="button button--small button--secondary">{{ 'customer.address.delete_address' | t }}</button>
          </form>
        </div>

        <toggle-element id="{{ address.id }}" class="dialog-window" preset="dialog">
          <div class="drawer" data-ref="toggle-element.dialog">
            <div class="drawer__header">
              <p class="text-h5">{{ 'customer.address.edit_address' | t }}</p>

              <button
                class="drawer__close button-reset"
                type="button"
                title="{{ 'accessibility.close_drawer' | t }}"
                data-ref="toggle-element.close"
              >
                {% render 'icon-misc', icon: 'cancel' %}
              </button>
            </div>

            <div class="drawer__body">
              {% render 'address-form', address: address %}
            </div>
          </div>
        </toggle-element>
      </li>
    {% endfor %}
  </ul>

  <div class="pagination">{{ paginate | default_pagination }}</div>
{% endpaginate %}

{% schema %}
{
  "name": "t:sections.main-addresses.name",
  "class": "main-account container",
  "settings": [
    {
      "type": "range",
      "id": "addresses_per_page",
      "label": "t:sections.main-addresses.settings.addresses_per_page.label",
      "min": 1,
      "max": 48,
      "default": 12
    }
  ]
}
{% endschema %}
